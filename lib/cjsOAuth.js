window={};var OAUTH_VERSION="1.0";function OAuth(a){if(window===this){return new OAuth(a)}return this.init(a)}OAuth.prototype={init:function(b){var a={debug:b.debug||false,consumerKey:b.consumerKey,consumerSecret:b.consumerSecret,accessTokenSecret:b.accessTokenSecret||"",signatureMethod:b.signatureMethod||"HMAC-SHA1"};this.request=function(q){var c,d,k,h,o,f,p,j,n,e,l,g,m=[];c=q.method||"GET";d=q.url;k=q.data||{};h=q.headers||{};o=q.success||function(i){};f=q.failure||function(){};if(a.debug){netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead UniversalBrowserWrite")}p=new XMLHttpRequest();p.onreadystatechange=function(){if(p.readyState==4&&(p.status==200||p.status==0)){o({text:p.responseText,xml:p.responseXML})}else{if(p.readyState==4&&p.status!=200&&p.status!=0){f({text:p.responseText,xml:p.responseXML})}}};for(j in k){m.push(j+"="+k[j])}n={oauth_callback:"oob",oauth_consumer_key:a.consumerKey,oauth_token:a.accessTokenSecret,oauth_signature_method:a.signatureMethod,oauth_timestamp:getTimestamp(),oauth_nonce:getNonce(),oauth_verifier:a.verifier||"",oauth_version:OAUTH_VERSION};e=a.signatureMethod;l=toSignatureBaseString(c,d,n,m);g=OAuth.signatureMethod[e](a.consumerSecret,a.accessTokenSecret,l);n.oauth_signature=g;m=m.sort().join("&");if(c=="GET"){if(m){d+="?"+m}m=null}else{p.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}p.open(c,d,true);p.setRequestHeader("Authorization","OAuth "+toHeaderString(n));p.setRequestHeader("X-Requested-With","XMLHttpRequest");for(j in h){p.setRequestHeader(j,h[j])}p.send(m)}},authenticate:function(a){},deauthenticate:function(a){},request:"",get:function(b,c,a){this.request({url:b,success:c,failure:a})},post:function(b,c,d,a){this.request({method:"POST",url:b,data:c,success:d,failure:a})},getJSON:function(b,c,a){this.get(b,function(d){c(JSON.parse(d.text))},a)},getXML:function(b,c,a){this.get(b,function(d){c(d.xml)},a)}};OAuth.signatureMethod={"HMAC-SHA1":function(a,c,d){var e,b;a=OAuth.urlEncode(a);c=OAuth.urlEncode(c||"");e=a+"&"+c;b=HMAC(SHA1(),e,d);return OAuth.btoa(b)}};function toHeaderString(c){var a=[],b;for(b in c){if(c[b]&&c[b]!=undefined&&c[b]!=""){a.push(b+'="'+OAuth.urlEncode(c[b]+"")+'"')}}return a.sort().join(", ")}function toSignatureBaseString(f,c,e,b){var a=[],d;for(d in e){if(e[d]&&e[d]!=undefined&&e[d]!=""){a.push(OAuth.urlEncode(d)+"="+OAuth.urlEncode(e[d]+""))}}for(d in b){if(b[d]&&b[d]!=undefined&&b[d]!=""){if(!oauth_header_params[d]){a.push(OAuth.urlEncode(d)+"="+OAuth.urlEncode(b[d]+""))}}}return[f,OAuth.urlEncode(c),OAuth.urlEncode(a.sort().join("&"))].join("&")}function getTimestamp(){return parseInt(+new Date/1000,10)}function getNonce(f){f=f||64;var h=f/8,g="",d=h/4,c=h%4,a,e=["20","21","22","23","24","25","26","27","28","29","2A","2B","2C","2D","2E","2F","30","31","32","33","34","35","36","37","38","39","3A","3B","3C","3D","3E","3F","40","41","42","43","44","45","46","47","48","49","4A","4B","4C","4D","4E","4F","50","51","52","53","54","55","56","57","58","59","5A","5B","5C","5D","5E","5F","60","61","62","63","64","65","66","67","68","69","6A","6B","6C","6D","6E","6F","70","71","72","73","74","75","76","77","78","79","7A","7B","7C","7D","7E"];for(a=0;a<d;a++){g+=e[b()]+e[b()]+e[b()]+e[b()]}for(a=0;a<c;a++){g+=e[b()]}function b(){return Math.floor(Math.random()*e.length)}return g}OAuth.urlEncode=function(a){if(!a){return""}a=a+"";var e=/ |!|\*|"|'|\(|\)|;|:|@|&|=|\+|\$|,|\/|\?|%|#|\[|\]|<|>|{|}|\||\\|`|\^/,c=a.length,b,d=a.split("");for(b=0;b<c;b++){if(d[b].match(e)){d[b]="%"+(d[b].charCodeAt(0)).toString(16).toUpperCase()}}return d.join("")};OAuth.urlDecode=function(a){if(!a){return""}return a.replace(/%[a-fA-F0-9]{2}/ig,function(b){return String.fromCharCode(parseInt(b.replace("%",""),16))})};function SHA1(c){if(window===this){return new SHA1(c)}if(arguments.length>0&&c!=undefined){var a=c,b,d;if(a.constructor===String){a=stringToByteArray(a)}b=new SHA1();d=b.hash(a);return byteArrayToHex(d)}return this}SHA1.prototype=new SHA1();SHA1.prototype.blocksize=64;SHA1.prototype.hash=function(u){var g=[1732584193,4023233417,2562383102,271733878,3285377520],f=[1518500249,1859775393,2400959708,3395469782],v,z,y,F,G,e,a,h,x,r,q,p,o,k,j,s,c;if(u.constructor===String){u=stringToByteArray(u)}v=u.length;z=(Math.ceil((v+9)/this.blocksize)*this.blocksize)-(v+9);y=[0,0,0,(v*8)];u=u.concat([128],zeroPad(z),[0,0,0,0],y);F=Math.ceil(u.length/this.blocksize);for(G=0;G<F;G++){e=u.slice(G*this.blocksize,(G+1)*this.blocksize);a=e.length;h=[];for(x=0;x<a;x++){h[x>>>2]|=e[x]<<(24-(x-((x>>2)*4))*8)}r=g[0];q=g[1];p=g[2];o=g[3];k=g[4];for(j=0;j<80;j++){if(j>=16){h[j]=leftrotate(h[j-3]^h[j-8]^h[j-14]^h[j-16],1)}s=Math.floor(j/20);c=leftrotate(r,5)+d(s,q,p,o)+k+f[s]+h[j];k=o;o=p;p=leftrotate(q,30);q=r;r=c}g[0]+=r;g[1]+=q;g[2]+=p;g[3]+=o;g[4]+=k}function d(b,m,l,i){switch(b){case 0:return(m&l)|((~m)&i);case 1:case 3:return m^l^i;case 2:return(m&l)|(m&i)|(l&i)}return -1}return wordsToByteArray(g)};function HMAC(g,h,n){var d=stringToByteArray(h),b=stringToByteArray(n),c=d.length,a,e,j,f;if(c>g.blocksize){d=g.hash(d);c=d.length}d=d.concat(zeroPad(g.blocksize-c));e=d.slice(0);j=d.slice(0);for(f=0;f<g.blocksize;f++){e[f]^=92;j[f]^=54}a=g.hash(e.concat(g.hash(j.concat(b))));return byteArrayToString(a)}function zeroPad(a){return new Array(a+1).join(0).split("")}function stringToByteArray(h){var a=[],c,f,g,e,d,b;for(c=0;c<h.length;c++){f=h.charCodeAt(c);g=(f>>>24);e=(f>>>16);d=(f>>>8);b=f&255;if(g>0){a.push(g)}if(e>0){a.push(e)}if(d>0){a.push(d)}if(b>0){a.push(b)}}return a}function wordsToByteArray(c){var a=[],b;for(b=0;b<c.length*32;b+=8){a.push((c[b>>>5]>>>(24-b%32))&255)}return a}function byteArrayToHex(b){var d=[],a=b.length,c;for(c=0;c<a;c++){d.push((b[c]>>>4).toString(16));d.push((b[c]&15).toString(16))}return d.join("")}function byteArrayToString(b){var c="",a=b.length,d;for(d=0;d<a;d++){c+=String.fromCharCode(b[d])}return c}function leftrotate(b,a){return(b<<a)|(b>>>(32-a))}exports.version=OAUTH_VERSION;exports.toHeaderString=toHeaderString;exports.toSignatureBaseString=toSignatureBaseString;exports.getTimestamp=getTimestamp;exports.getNonce=getNonce;